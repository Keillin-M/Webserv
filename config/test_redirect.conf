# Test configuration with HTTP redirection

server {
    listen 8080;
    root www;
    index index.html;
    client_max_body_size 1M;
    
    # Custom error pages
    error_page 400 /errors/400.html;
    error_page 403 /errors/403.html;
    error_page 404 /errors/404.html;
    error_page 405 /errors/405.html;
    error_page 500 /errors/500.html;
    error_page 501 /errors/501.html;
    error_page 505 /errors/505.html;
    
    # Main location - allows GET and POST
    location / {
        root www;
        allowed_methods GET POST;
        index index.html;
    }
    
    # Permanent redirect example
    location /old-blog/ {
        return 301 http://localhost:8080/pages/;
    }
    
    # Temporary redirect example  
    location /temp-redirect/ {
        return 302 http://localhost:8080/;
    }
    
    # HTTPS redirect example
    location /secure/ {
        return 301 https://localhost:8443/;
    }
    
    # Uploads directory - allows GET, POST and DELETE
    location /uploads/ {
        root www;
        allowed_methods GET POST DELETE;
        autoindex on;
    }
    
    # Pages directory - allows GET (autoindex or 403)
    location /pages/ {
        root www;
        allowed_methods GET;
        autoindex on;
    }
    
    # CGI support for Python scripts
    location /cgi-bin/ {
        root config;
        allowed_methods GET POST;
        cgi_extension .py;
        cgi_path /usr/bin/python3;
    }
    
    # Custom redirect locations for testing
    # These locations return HTTP 301 and 302 status codes for /redirect/301 and /redirect/302
    location /redirect/301 {
        return 301 /pages/about.html;
        allowed_methods GET;
    }

    # Temporary redirect for /redirect/302
    location /redirect/302 {
        return 302 /pages/about.html;
        allowed_methods GET;
    }
}