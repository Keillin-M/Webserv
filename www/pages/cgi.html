<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGI Tests | Webserv</title>
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
    <!-- Hero Section -->
    <div class="hero">
        <img src="../assets/img/hero.svg" alt="Webserv Test Playground" class="hero-image">
        <h1>CGI Tests</h1>
        <p>Test Common Gateway Interface scripts (Python)</p>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Navigation -->
        <nav class="nav">
            <a href="../index.html" class="nav-btn">Home</a>
            <a href="get.html" class="nav-btn">GET Tests</a>
            <a href="post.html" class="nav-btn">POST Tests</a>
            <a href="delete.html" class="nav-btn">DELETE Tests</a>
            <a href="redirect.html" class="nav-btn">Redirections</a>
            <a href="errors.html" class="nav-btn">Error Pages</a>
            <a href="cgi.html" class="nav-btn active">CGI Tests</a>
            <a href="about.html" class="nav-btn">About</a>
        </nav>

        <!-- About CGI -->
        <div class="card">
            <h2>About CGI</h2>
            <p><strong>CGI (Common Gateway Interface)</strong> allows the server to execute scripts and return dynamic content. Instead of serving a static file (like <code>index.html</code>), the server <em>executes</em> a program and sends the result.</p>
            <div style="margin-top: 15px; color: var(--text-secondary); line-height: 1.8;">
                <p><strong style="color: var(--accent-green);">Example: GET /cgi-bin/hello.py</strong></p>
                <ol style="margin-left: 20px;">
                    <li>Browser requests <code>/cgi-bin/hello.py</code></li>
                    <li>Server sees <code>.py</code> extension → it's CGI!</li>
                    <li>Server runs: <code>/usr/bin/python3 www/cgi-bin/hello.py</code></li>
                    <li>Python script prints HTML to stdout</li>
                    <li>Server captures output and sends as HTTP response</li>
                </ol>
                <p style="margin-top: 15px;"><strong style="color: var(--accent-blue);">Available scripts:</strong></p>
                <ul style="margin-left: 20px;">
                    <li><code>hello.py</code> - Returns "Hello World" (basic test)</li>
                    <li><code>env.py</code> - Shows CGI environment variables</li>
                    <li><code>form.py</code> - Processes POST form data</li>
                </ul>
            </div>
        </div>

        <!-- Test CGI Scripts -->
        <div class="card">
            <h2>Test CGI Scripts</h2>
            <p>Click to open scripts in a new tab. The browser will request the script and display the result.</p>
            
            <div class="test-grid" style="margin-top: 20px;">
                <div class="test-card">
                    <h3 style="color: var(--accent-green);">GET: Hello World</h3>
                    <p>Basic CGI test - returns HTML</p>
                    <code style="font-size: 0.85rem;">/cgi-bin/hello.py</code>
                    <a href="/cgi-bin/hello.py" target="_blank" class="btn" style="display: inline-block; margin-top: 10px;">Open</a>
                </div>
                <div class="test-card">
                    <h3 style="color: var(--accent-blue);">GET: Environment</h3>
                    <p>Shows all CGI variables</p>
                    <code style="font-size: 0.85rem;">/cgi-bin/env.py</code>
                    <a href="/cgi-bin/env.py" target="_blank" class="btn btn-info" style="display: inline-block; margin-top: 10px;">Open</a>
                </div>
                <div class="test-card">
                    <h3 style="color: var(--accent-purple);">GET: Query String</h3>
                    <p>GET with <code>?name=test&value=42</code></p>
                    <code style="font-size: 0.85rem;">/cgi-bin/env.py?...</code>
                    <a href="/cgi-bin/env.py?name=test&value=42" target="_blank" class="btn" style="display: inline-block; margin-top: 10px; background: var(--accent-purple);">Open</a>
                </div>
                <div class="test-card">
                    <h3 style="color: var(--accent-green);">POST: Form</h3>
                    <p>Has form to test POST</p>
                    <code style="font-size: 0.85rem;">/cgi-bin/form.py</code>
                    <a href="/cgi-bin/form.py" target="_blank" class="btn btn-success" style="display: inline-block; margin-top: 10px;">Open</a>
                </div>
            </div>
        </div>

        <!-- Error Tests -->
        <div class="card">
            <h2>Error Handling Tests</h2>
            <p>Test that the server does <strong>NOT crash</strong> when CGI fails. After each error test, verify the server still works by opening <code>hello.py</code> again.</p>
            
            <div class="test-grid" style="margin-top: 20px;">
                <div class="test-card">
                    <h3 style="color: var(--error);">404 Not Found</h3>
                    <p>Script doesn't exist → server returns 404</p>
                    <code style="font-size: 0.85rem;">/cgi-bin/nonexistent.py</code>
                    <a href="/cgi-bin/nonexistent.py" target="_blank" class="btn btn-danger" style="display: inline-block; margin-top: 10px;">Open</a>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 8px;"><strong>Expected:</strong> 404 error page</p>
                </div>
                <div class="test-card">
                    <h3 style="color: var(--error);">Runtime Error</h3>
                    <p>Script crashes on purpose (Python bug)</p>
                    <code style="font-size: 0.85rem;">/cgi-bin/error.py</code>
                    <a href="/cgi-bin/error.py" target="_blank" class="btn btn-danger" style="display: inline-block; margin-top: 10px;">Open</a>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 8px;"><strong>Expected:</strong> "About to crash..." then script dies. Server continues working.</p>
                </div>
            </div>
            
            <div style="margin-top: 20px; padding: 15px; background: var(--bg-tertiary); border-radius: 8px; border-left: 4px solid var(--accent-green);">
                <p style="margin: 0;"><strong style="color: var(--accent-green);">How to verify:</strong> After testing errors above, click the button below. If it works, the server handled the errors correctly.</p>
                <a href="/cgi-bin/hello.py" target="_blank" class="btn" style="display: inline-block; margin-top: 10px;">Verify: Open hello.py</a>
            </div>
        </div>
    </div>
</body>
</html>
